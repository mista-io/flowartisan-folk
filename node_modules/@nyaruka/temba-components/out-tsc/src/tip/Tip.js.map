{"version":3,"file":"Tip.js","sourceRoot":"","sources":["../../../src/tip/Tip.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators';\nimport { styleMap } from 'lit-html/directives/style-map';\nimport { RapidElement } from '../RapidElement';\nimport { getClasses } from '../utils';\nimport { getCenter, getMiddle } from './helpers';\n\nexport class Tip extends RapidElement {\n  static get styles() {\n    return css`\n      .tip {\n        transition: opacity 200ms ease-in-out;\n        margin: 0px;\n        position: fixed;\n        opacity: 0;\n        background: #fff;\n        padding: 4px 8px;\n        pointer-events: none;\n        border-radius: var(--curvature-widget);\n        box-shadow: 0 1px 10px 10px rgba(0, 0, 0, 0.035),\n          0 1px 3px 0px rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);\n        font-size: 14px;\n        z-index: 10000;\n        color: #333;\n      }\n\n      .tip.hide-on-change {\n        transition: none;\n      }\n\n      .show {\n        opacity: 1;\n      }\n\n      .slot {\n        display: flex;\n        flex-direction: column;\n      }\n\n      .arrow {\n        position: absolute;\n        color: #fff;\n        font-size: 10px;\n        line-height: 0px;\n      }\n\n      .◀ {\n        text-shadow: -1px 2px 2px rgba(0, 0, 0, 0.1);\n      }\n\n      .▶ {\n        text-shadow: 1px 2px 2px rgba(0, 0, 0, 0.1);\n      }\n\n      .▼ {\n        text-shadow: 0px 3px 3px rgba(0, 0, 0, 0.1);\n      }\n\n      .▲ {\n        text-shadow: 0px -1px 1px rgba(0, 0, 0, 0.1);\n      }\n    `;\n  }\n  @property({ type: String })\n  text: string;\n\n  @property({ type: Boolean })\n  visible = false;\n\n  @property({ type: String })\n  position = 'auto';\n\n  @property({ type: Boolean })\n  hideOnChange: boolean;\n\n  @property({ type: Number, attribute: false })\n  top: number;\n\n  @property({ type: Number, attribute: false })\n  left: number;\n\n  @property({ type: Number, attribute: false })\n  width: number;\n\n  @property({ type: Boolean, attribute: false })\n  poppedTop: boolean;\n\n  arrow: string;\n\n  arrowTop: number;\n  arrowLeft: number;\n  arrowDirection: string;\n\n  public updated(changed: Map<string, any>) {\n    if ((changed.has('visible') || changed.has('text')) && this.visible) {\n      this.calculatePosition();\n    }\n\n    if (changed.has('text') && this.hideOnChange) {\n      this.visible = false;\n    }\n  }\n\n  private calculatePosition() {\n    if (this.visible) {\n      const tipBounds = this.getDiv('.tip').getBoundingClientRect();\n      const anchorBounds = this.getDiv('.slot').getBoundingClientRect();\n\n      // TODO: pick a direction automatically\n      let tipSide = this.position;\n      if (tipSide === 'auto') {\n        tipSide = 'left';\n      }\n\n      this.arrowLeft = 0;\n      this.arrowTop = 0;\n\n      if (tipSide === 'left') {\n        this.left = anchorBounds.left - tipBounds.width - 16;\n        this.top = getMiddle(anchorBounds, tipBounds);\n\n        // position our arrow\n        this.arrowTop = tipBounds.height / 2;\n        this.arrowLeft = tipBounds.width - 1;\n        this.arrow = '▶';\n      } else if (tipSide === 'right') {\n        this.left = anchorBounds.right + 12;\n        this.top = getMiddle(anchorBounds, tipBounds);\n\n        this.arrowTop = tipBounds.height / 2;\n        this.arrowLeft = -8;\n        this.arrow = '◀';\n      } else if (tipSide === 'top') {\n        this.top = anchorBounds.top - tipBounds.height - 12;\n        this.left = getCenter(anchorBounds, tipBounds);\n\n        this.arrowTop = tipBounds.height + 2;\n        this.arrowLeft = tipBounds.width / 2 - 4;\n        this.arrow = '▼';\n      } else if (tipSide === 'bottom') {\n        this.top = anchorBounds.bottom + 10;\n        this.left = getCenter(anchorBounds, tipBounds);\n\n        this.arrowTop = -2;\n        this.arrowLeft = tipBounds.width / 2 - 3;\n        this.arrow = '▲';\n      }\n    }\n  }\n\n  lastEnter = 0;\n  failSafe = 0;\n\n  private handleMouseEnter() {\n    this.lastEnter = window.setTimeout(() => {\n      this.visible = true;\n      this.failSafe = window.setTimeout(() => {\n        this.visible = false;\n      }, 2000);\n    }, 600);\n  }\n\n  private handleMouseLeave() {\n    window.clearTimeout(this.lastEnter);\n    window.clearTimeout(this.failSafe);\n    this.visible = false;\n  }\n\n  public render(): TemplateResult {\n    const tipStyle: any = {\n      top: this.top ? `${this.top}px` : '0px',\n      left: this.left ? `${this.left}px` : '0px',\n    };\n\n    const arrowStyle: any = {\n      top: this.arrowTop ? `${this.arrowTop}px` : '0px',\n      left: this.arrowLeft ? `${this.arrowLeft}px` : '0px',\n    };\n\n    if (this.width) {\n      tipStyle.width = `${this.width}px`;\n    }\n\n    const classes = getClasses({\n      tip: true,\n      show: this.visible,\n      top: this.poppedTop,\n      'hide-on-change': this.hideOnChange,\n    });\n\n    return html`\n      <div\n        class=\"slot\"\n        @click=${this.handleMouseLeave}\n        @mouseenter=${this.handleMouseEnter}\n        @mouseleave=${this.handleMouseLeave}\n      >\n        <slot></slot>\n      </div>\n      <div class=\"${classes}\" style=${styleMap(tipStyle)}>\n        ${this.text}\n        <div class=\"arrow ${this.arrow}\" style=${styleMap(arrowStyle)}>\n          ${this.arrow}\n        </div>\n      </div>\n    `;\n  }\n}\n"]}