{"version":3,"file":"AliasEditor.js","sourceRoot":"","sources":["../../../src/aliaseditor/AliasEditor.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html, LitElement, TemplateResult } from 'lit';\nimport { FeatureProperties } from '../interfaces';\nimport { getUrl, postJSON, WebResponse } from '../utils';\nimport { TextInput } from '../textinput/TextInput';\nimport { styleMap } from 'lit-html/directives/style-map';\nimport { FormElement } from '../FormElement';\n\nimport { property } from 'lit/decorators';\n\nexport class AliasEditor extends LitElement {\n  static get styles() {\n    return css`\n      :host {\n        line-height: normal;\n      }\n\n      temba-textinput {\n        height: 150px;\n      }\n\n      #left-column {\n        display: inline-block;\n        margin-left: 10px;\n        width: 300px;\n        z-index: 100;\n      }\n\n      .search {\n        margin-bottom: 10px;\n      }\n\n      .feature {\n        padding: 4px 14px;\n        font-size: 16px;\n      }\n\n      .level-0 {\n        margin-left: 0px;\n      }\n\n      .level-1 {\n        margin-left: 5px;\n        font-size: 95%;\n      }\n\n      .level-2 {\n        margin-left: 10px;\n        font-size: 90%;\n      }\n\n      .level-3 {\n        margin-left: 15px;\n        font-size: 85%;\n      }\n\n      .feature-name {\n        display: inline-block;\n      }\n\n      .clickable {\n        text-decoration: none;\n        cursor: pointer;\n        color: var(--color-link-primary);\n      }\n\n      .clickable.secondary {\n        color: var(--color-link-secondary);\n      }\n\n      .clickable:hover {\n        text-decoration: underline;\n        color: var(--color-link-primary-hover);\n      }\n\n      .feature:hover .showonhover {\n        visibility: visible;\n      }\n\n      .showonhover {\n        visibility: hidden;\n      }\n\n      .aliases {\n        color: #bbb;\n        font-size: 80%;\n        display: inline;\n        margin-left: 5px;\n      }\n\n      temba-label {\n        margin-right: 3px;\n        margin-bottom: 3px;\n        vertical-align: top;\n      }\n\n      .selected {\n        display: flex;\n        flex-direction: column;\n        padding: 15px;\n        padding-bottom: 40px;\n      }\n\n      .selected .name {\n        font-size: 18px;\n        padding: 5px;\n      }\n\n      .selected .help {\n        padding: 5px 2px;\n        font-size: 11px;\n        color: var(--color-secondary-light);\n      }\n\n      #right-column {\n        vertical-align: top;\n        margin-left: 20px;\n        display: inline-block;\n      }\n\n      leaflet-map {\n        height: 250px;\n        width: 450px;\n        border: 0px solid #999;\n        border-radius: var(--curvature);\n      }\n\n      .edit {\n        display: inline-block;\n        margin-right: 0px;\n      }\n    `;\n  }\n\n  @property({ type: Array, attribute: false })\n  path: FeatureProperties[] = [];\n\n  @property()\n  endpoint: string;\n\n  @property()\n  osmId: string;\n\n  @property({ type: Object })\n  hovered: FeatureProperties;\n\n  @property({ type: Object })\n  editFeature: FeatureProperties;\n\n  @property({ type: String, attribute: false })\n  editFeatureAliases: string;\n\n  public constructor() {\n    super();\n  }\n\n  public updated(changedProperties: Map<string, any>) {\n    if (changedProperties.has('osmId')) {\n      // going up the tree doesn't require a fetch\n      const newPath = [];\n      for (const feature of this.path) {\n        newPath.push(feature);\n        if (feature.osm_id === this.osmId) {\n          this.path = [...newPath];\n          this.hideAliasDialog();\n          return;\n        }\n      }\n\n      this.fetchFeature();\n    }\n  }\n\n  private fetchFeature() {\n    getUrl(this.getEndpoint() + 'boundaries/' + this.osmId + '/').then(\n      (response: WebResponse) => {\n        this.path = response.json as FeatureProperties[];\n        this.hideAliasDialog();\n      }\n    );\n  }\n\n  private handleMapClicked(feature: FeatureProperties): void {\n    this.hovered = null;\n    if (!feature || feature.osm_id !== this.osmId) {\n      this.osmId = feature.osm_id;\n    }\n  }\n\n  private handlePlaceClicked(feature: FeatureProperties) {\n    this.osmId = feature.osm_id;\n  }\n\n  private handleSearchSelection(evt: CustomEvent) {\n    const selection = evt.detail.selected as FeatureProperties;\n    this.showAliasDialog(selection);\n    const select = this.shadowRoot.querySelector('temba-select') as FormElement;\n    select.clear();\n  }\n\n  private isMatch(option: any, query: string) {\n    return `${option.name} ${option.aliases}`.toLowerCase().indexOf(query) > -1;\n  }\n\n  private renderFeature(\n    feature: FeatureProperties,\n    remainingPath: FeatureProperties[]\n  ): TemplateResult {\n    const selectedFeature = this.path[this.path.length - 1];\n    const clickable =\n      (feature.has_children || feature.level === 0) &&\n      feature !== selectedFeature;\n    const renderedFeature = html`\n      <div class=\"feature\">\n        <div\n          @mouseover=${() => {\n            if (feature.level > 0) {\n              this.hovered = feature;\n            }\n          }}\n          @mouseout=${() => {\n            this.hovered = null;\n          }}\n          class=\"level-${feature.level}\"\n        >\n          <div\n            class=\"feature-name ${clickable ? 'clickable' : ''}\"\n            @click=${() => {\n              if (clickable) {\n                this.handlePlaceClicked(feature);\n              }\n            }}\n          >\n            ${feature.name}\n          </div>\n\n          <div class=\"aliases\">\n            ${feature.aliases.split('\\n').map((alias: string) =>\n              alias.trim().length > 0\n                ? html`\n                    <temba-label\n                      class=\"alias\"\n                      @click=${() => {\n                        this.showAliasDialog(feature);\n                      }}\n                      light\n                      clickable\n                      >${alias}</temba-label\n                    >\n                  `\n                : null\n            )}\n            ${feature.level > 0\n              ? html`\n                  <div\n                    class=\"edit clickable showonhover\"\n                    @click=${(evt: MouseEvent) => {\n                      this.showAliasDialog(feature);\n                      evt.preventDefault();\n                      evt.stopPropagation();\n                    }}\n                  >\n                    <temba-icon name=\"edit\" />\n                  </div>\n                `\n              : ''}\n          </div>\n        </div>\n      </div>\n    `;\n\n    const renderedChildren = (feature.children || []).map(\n      (child: FeatureProperties) => {\n        if (\n          remainingPath.length > 0 &&\n          remainingPath[0].osm_id === child.osm_id\n        ) {\n          return this.renderFeature(remainingPath[0], remainingPath.slice(1));\n        }\n\n        if (\n          remainingPath.length === 0 ||\n          remainingPath[0].children.length === 0\n        ) {\n          return this.renderFeature(child, remainingPath);\n        }\n\n        return null;\n      }\n    );\n\n    return html` ${renderedFeature} ${renderedChildren} `;\n  }\n\n  public showAliasDialog(feature: FeatureProperties) {\n    this.editFeatureAliases = feature.aliases;\n    this.editFeature = feature;\n    const aliasDialog = this.shadowRoot.getElementById('alias-dialog');\n    if (aliasDialog) {\n      aliasDialog.setAttribute('open', '');\n    }\n  }\n\n  public hideAliasDialog() {\n    const aliasDialog = this.shadowRoot.getElementById('alias-dialog');\n    this.editFeature = null;\n    this.editFeatureAliases = null;\n    if (aliasDialog) {\n      aliasDialog.removeAttribute('open');\n    }\n\n    this.requestUpdate();\n  }\n\n  private getEndpoint(): string {\n    return this.endpoint + (!this.endpoint.endsWith('/') ? '/' : '');\n  }\n\n  private handleDialogClick(evt: CustomEvent) {\n    const button = evt.detail.button;\n    if (button.name === 'Save') {\n      const textarea = this.shadowRoot.getElementById(\n        this.editFeature.osm_id\n      ) as TextInput;\n      const aliases = textarea.inputElement.value;\n      const payload = { osm_id: this.editFeature.osm_id, aliases };\n      postJSON(\n        this.getEndpoint() + 'boundaries/' + this.editFeature.osm_id + '/',\n        payload\n      ).then(() => {\n        this.fetchFeature();\n      });\n    }\n\n    if (button.name === 'Cancel') {\n      this.hideAliasDialog();\n    }\n  }\n\n  private getOptions(response: WebResponse) {\n    return response.json.filter((option: any) => option.level > 0);\n  }\n\n  private getOptionsComplete(newestOptions: FeatureProperties[]) {\n    return newestOptions.length === 0;\n  }\n\n  private renderOptionDetail(option: FeatureProperties): TemplateResult {\n    const labelStyles = {\n      marginTop: '3px',\n      marginRight: '3px',\n    };\n\n    const aliasList = option.aliases.split('\\n');\n    const aliases = aliasList.map((alias: string) =>\n      alias.trim().length > 0\n        ? html`\n            <temba-label style=${styleMap(labelStyles)} class=\"alias\" dark\n              >${alias}</temba-label\n            >\n          `\n        : null\n    );\n    return html`\n      <div class=\"path\">${option.path.replace(/>/gi, '‣')}</div>\n      <div class=\"aliases\">${aliases}</div>\n    `;\n  }\n\n  public render(): TemplateResult {\n    if (this.path.length === 0) {\n      return html``;\n    }\n\n    // if we are a leaf, have our map show the level above\n    const selectedFeature = this.path[this.path.length - 1];\n    const mapFeature =\n      selectedFeature.children.length === 0\n        ? this.path[this.path.length - 2]\n        : selectedFeature;\n\n    const editFeatureId = this.editFeature ? this.editFeature.osm_id : null;\n    const editFeatureName = this.editFeature ? this.editFeature.name : null;\n\n    return html`\n      <div id=\"left-column\">\n        <div class=\"search\">\n          <temba-select\n            placeholder=\"Search\"\n            endpoint=\"${this.getEndpoint()}boundaries/${this.path[0].osm_id}/?\"\n            .renderOptionDetail=${this.renderOptionDetail}\n            .getOptions=${this.getOptions}\n            .isComplete=${this.getOptionsComplete}\n            .isMatch=${this.isMatch}\n            @temba-selection=${this.handleSearchSelection.bind(this)}\n            queryParam=\"q\"\n            searchable\n          ></temba-select>\n        </div>\n        <div class=\"feature-tree\">\n          ${this.renderFeature(this.path[0], this.path.slice(1))}\n        </div>\n      </div>\n\n      <div id=\"right-column\">\n        <leaflet-map\n          endpoint=${this.getEndpoint()}\n          .feature=${mapFeature}\n          .osmId=${mapFeature.osm_id}\n          .hovered=${this.hovered}\n          .onFeatureClicked=${this.handleMapClicked.bind(this)}\n        >\n        </leaflet-map>\n      </div>\n\n      <temba-dialog\n        id=\"alias-dialog\"\n        header=\"Aliases for ${editFeatureName}\"\n        primaryButtonName=\"Save\"\n        @temba-button-clicked=${this.handleDialogClick.bind(this)}\n      >\n        <div class=\"selected\">\n          <temba-textinput\n            .helpText=\"Enter other aliases for ${editFeatureName}, one per line\"\n            name=\"aliases\"\n            id=${editFeatureId}\n            .value=${this.editFeatureAliases}\n            textarea\n          ></temba-textinput>\n        </div>\n      </temba-dialog>\n    `;\n  }\n}\n"]}