{"version":3,"file":"RapidElement.js","sourceRoot":"","sources":["../../src/RapidElement.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement } from 'lit';\nimport { CustomEventType } from './interfaces';\n\nexport interface EventHandler {\n  event: string;\n  method: EventListener;\n  isDocument?: boolean;\n}\n\nexport class RapidElement extends LitElement {\n  private eles: { [selector: string]: HTMLDivElement } = {};\n\n  public getEventHandlers(): EventHandler[] {\n    return [];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    for (const handler of this.getEventHandlers()) {\n      if (handler.isDocument) {\n        document.addEventListener(handler.event, handler.method.bind(this));\n      } else {\n        this.addEventListener(handler.event, handler.method.bind(this));\n      }\n    }\n  }\n\n  disconnectedCallback() {\n    for (const handler of this.getEventHandlers()) {\n      if (handler.isDocument) {\n        document.removeEventListener(handler.event, handler.method);\n      } else {\n        this.removeEventListener(handler.event, handler.method);\n      }\n    }\n    super.disconnectedCallback();\n  }\n\n  public fireEvent(type: string): any {\n    return this.dispatchEvent(\n      new Event(type, {\n        bubbles: true,\n        composed: true,\n      })\n    );\n  }\n\n  public fireCustomEvent(type: CustomEventType, detail: any = {}): any {\n    const event = new CustomEvent(type, {\n      detail,\n      bubbles: true,\n      composed: true,\n    });\n\n    return this.dispatchEvent(event);\n  }\n\n  public dispatchEvent(event: any): any {\n    super.dispatchEvent(event);\n    const ele = event.target;\n    if (ele) {\n      // lookup events with - prefix and try to invoke them\n      const eventFire = (ele as any)['-' + event.type];\n      if (eventFire) {\n        return eventFire(event);\n      } else {\n        const func = new Function(\n          'event',\n          `with(document) {\n          with(this) {\n            let handler = ${ele.getAttribute('-' + event.type)};\n            if(typeof handler === 'function') { \n              handler(event) ;\n            }\n          }\n        }`\n        );\n        return func.call(ele, event);\n      }\n    }\n  }\n\n  public closestElement(selector: string, base: Element = this) {\n    function __closestFrom(el: Element | Window | Document): Element {\n      if (!el || el === document || el === window) return null;\n      if ((el as any).assignedSlot) el = (el as any).assignedSlot;\n      const found = (el as Element).closest(selector);\n      return found\n        ? found\n        : __closestFrom(((el as Element).getRootNode() as ShadowRoot).host);\n    }\n    return __closestFrom(base);\n  }\n\n  public getDiv(selector: string) {\n    let ele = this.eles[selector];\n    if (ele) {\n      return ele;\n    }\n\n    ele = this.shadowRoot.querySelector(selector);\n    if (ele) {\n      this.eles[selector] = ele;\n    }\n    return ele;\n  }\n}\n"]}